:root{
  --bg:#0e1320;--panel:#141a2a;--accent:#6ee7ff;--accent2:#a78bfa;--text:#e6f1ff;--danger:#ff6b6b;--ok:#34d399;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;color:var(--text);background:linear-gradient(180deg,#0a0f1d,#0e1320 40%,#0b1020)}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
.title{font-size:clamp(18px,2.6vw,26px);font-weight:700;letter-spacing:.2px}
.controls{display:flex;gap:8px;flex-wrap:wrap}
button, select{background:var(--panel);color:var(--text);border:1px solid #26314d;padding:8px 10px;border-radius:12px;cursor:pointer}
button:hover{border-color:#3a4b75}
.badge{background:#10182b;border:1px solid #28365c;border-radius:10px;padding:6px 10px;font-size:13px;display:inline-flex;align-items:center;gap:6px}
.hud{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.hearts{display:flex;gap:4px}
.heart{width:18px;height:18px;background:conic-gradient(from 0deg,var(--danger),#ff98a8);clip-path:path("M12 21s-7.364-4.39-9.192-8.335C1.037 10.21 1.9 7.5 4.5 7.5c1.77 0 2.937 1.07 3.5 2 0.563-.93 1.73-2 3.5-2 2.6 0 3.463 2.71 1.692 5.165C19.364 16.61 12 21 12 21Z");filter:drop-shadow(0 0 4px #ff6b6b55)}
canvas{width:100%;max-width:1100px;height:auto;border-radius:16px;display:block;border:1px solid #223157;background:#0a0f1d;box-shadow:0 8px 24px #0008}
.legend{margin-top:8px;font-size:13px;color:#cbd5e1;opacity:.9}

/* Modal */
.modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(4,8,18,.72);backdrop-filter:blur(6px);z-index:10}
.card{width:min(560px,92%);background:linear-gradient(180deg,#11182a,#0f1525);border:1px solid #273458;border-radius:18px;padding:16px 16px 12px;box-shadow:0 10px 32px #000a}
.q-h{font-weight:700;font-size:18px;margin:4px 0 8px}
.q-body{font-size:16px;margin:6px 0 12px;color:#e9f2ff}
.opts{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.opt{padding:12px;border-radius:12px;border:1px solid #2a3a60;background:#0e1730;cursor:pointer}
.opt.correct{outline:2px solid var(--ok)}
.opt.wrong{outline:2px solid var(--danger)}
.meta{display:flex;gap:8px;align-items:center;margin-top:10px;font-size:13px;color:#a3b2d6}

.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:#0e1730;border:1px solid #2a3a60;color:#dbe9ff;padding:10px 14px;border-radius:12px;display:none}

/* Touch D-pad */
.dpad{position:fixed;right:14px;bottom:14px;display:grid;grid-template-columns:48px 48px 48px;grid-template-rows:48px 48px 48px;gap:6px;opacity:.6}
.dpad button{border-radius:10px}
.dpad .empty{visibility:hidden}